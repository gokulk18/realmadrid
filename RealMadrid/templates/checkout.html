{% load static %}
{% load tz %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
    <title>Real Madrid FC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.21.6/dist/css/uikit.min.css" />

    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.6/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.6/dist/js/uikit-icons.min.js"></script>
    <script src="//unpkg.com/alpinejs" defer></script>
    <style>
        .hover-zoom:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease-in-out;
        }
        .uk-slider-container .uk-slidenav {
            color: white; /* Default color */
            transition: color 0.3s ease; /* Smooth transition */
        }
    
        .uk-slider-container .uk-slidenav:hover {
            color: #3b82f6; /* Blue color on hover */
        }
        .rounded-lg {
            border-radius: 1rem; /* Adjust radius as needed */
            overflow: hidden; /* Ensures the image fits within the rounded corners */
        }
    
        .hover\:scale-105:hover {
            transform: scale(1.05); /* Zoom effect on hover */
        }
        a{
            text-decoration: none !important;
        }
    </style>
</head>
<body class="bg-[#f3f5f8]">


<!-- Navbar Section -->
<section class="bg-white dark:bg-white-900">
    <nav id="navbar"  class="fixed inset-x-0 z-30 container p-6 mx-auto lg:flex lg:justify-between lg:items-center bg-white text-[#43526e] transition-transform duration-300 ease-in-out transform top-0">
        <div class="flex items-center justify-between">
            <a href="#" class="flex items-center">
                <img class="w-auto h-6 sm:h-7" src="{% static 'madrid_images/real-madrid-logo.png' %}" alt="Real Madrid Logo">
                <span class="ml-2 lg:ml-6 hover:text-blue-500">REAL MADRID FC</span>
            </a>
    
        </div>
    </nav>
</section>
<body class="bg-gray-100 font-sans" x-data="checkoutData()" x-init="init()">    

    <div class="flex flex-wrap -mx-4">
        <div class="w-full lg:w-2/3 px-4 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6" style="margin-top: 104px;">
                <div class="flex mb-6 border-b">
                    <div class="w-1/3 text-center">
                        <button class="text-blue-600 font-semibold pb-2 border-b-2 border-blue-600">Your details</button>
                    </div>
                    <div class="w-1/3 text-center">
                        <button class="text-gray-500">Shipping</button>
                    </div>
                    <div class="w-1/3 text-center">
                        <button class="text-gray-500">Payment</button>
                    </div>
                </div>

                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4">Your details</h2>
                    <div class="text-right mb-2">
                        {% comment %} <a href="#" class="text-blue-600 text-sm">Do you already have an account? Login</a> {% endcomment %}
                    </div>
                    <div class="mb-4">
                        <label for="fullname" class="block text-sm font-medium text-gray-700 mb-1">Full name*</label>
                        <input type="text" id="fullname" name="fullname" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                    </div>
                    <div class="mb-4">
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email*</label>
                        <input type="email" id="email" name="email" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                    </div>
                    <div class="mb-4">
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone*</label>
                        <input type="tel" id="phone" name="phone" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                        <p class="text-xs text-gray-500 mt-1">We will only use it if we need to contact you regarding your order</p>
                    </div>
                </div>

                <div>
                    <h2 class="text-xl font-semibold mb-4">Shipping address</h2>
                    <div class="mb-4">
                        <label for="country" class="block text-sm font-medium text-gray-700 mb-1">Country / Region*</label>
                        <select id="country" name="country" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md appearance-none">
                            <option>Spain</option>
                            <!-- Add more countries as needed -->
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="address" class="block text-sm font-medium text-gray-700 mb-1">Address*</label>
                        <input type="text" id="address" name="address" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                    </div>
                    <div class="mb-4">
                        <label for="apartment" class="block text-sm font-medium text-gray-700 mb-1">Apartment, suite, etc. (optional)</label>
                        <input type="text" id="apartment" name="apartment" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                    </div>
                    <div class="flex -mx-2 mb-4">
                        <div class="w-1/2 px-2">
                            <label for="zipcode" class="block text-sm font-medium text-gray-700 mb-1">Zip code*</label>
                            <input type="text" id="zipcode" name="zipcode" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                        </div>
                        <div class="w-1/2 px-2">
                            <label for="city" class="block text-sm font-medium text-gray-700 mb-1">City*</label>
                            <input type="text" id="city" name="city" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="state" class="block text-sm font-medium text-gray-700 mb-1">State / Province / Region*</label>
                        <select id="state" name="state" class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md appearance-none">
                            <option>Select state</option>
                            <!-- Add states/provinces here -->
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600">
                            <span class="ml-2 text-sm text-gray-700">
                                I consent that REAL MADRID send me commercial information and communications, including electronically and after profiling, of Real Madrid products, services and activities, including the Online Store, and its sponsors and collaborators. You can exercise your data protection rights at <a href="mailto:opposition@corp.realmadrid.com" class="text-blue-600">opposition@corp.realmadrid.com</a>
                            </span>
                        </label>
                    </div>
                    <div class="mt-6">
                        <button class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300">
                            Continue shipping
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="w-full lg:w-1/3 px-4">
            <div class="bg-white rounded-lg shadow-md p-6" style=" margin-top: 104px;">
                <h2 class="text-xl font-semibold mb-4">Your basket</h2>
                <p class="text-sm text-gray-600 mb-4" x-show="availableItems.length > 0">
                    <span x-text="availableItems.length"></span> Article<span x-show="availableItems.length > 1">s</span>
                </p>
                <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4" role="alert">
                    <p class="text-sm">Custom items will require an additional 3-4 business days to process and shipping option.</p>
                </div>
                <template x-for="item in availableItems" :key="item.id">
                    <div class="flex items-center mb-4">
                        <img :src="item.image" :alt="item.name" class="w-20 h-20 object-cover mr-4">
                        <div>
                            <h3 x-text="item.name" class="font-semibold"></h3>
                            <p x-text="'Quantity: ' + item.quantity" class="text-sm text-gray-600"></p>
                            <p x-text="'Size: ' + item.size" class="text-sm text-gray-600"></p>
                            <p x-text="'€' + item.total.toFixed(2)" class="font-semibold mt-1"></p>
                        </div>
                    </div>
                </template>
                <div class="border-t pt-4 mt-4">
                    <div class="flex justify-between mb-2">
                        <span>Subtotal</span>
                        <span x-text="'€' + cartTotal.toFixed(2)"></span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span>Shipping</span>
                        <span>It will be calculated in the next step</span>
                    </div>
                    <div class="flex justify-between font-bold text-lg mt-4">
                        <span>Total</span>
                        <span x-text="'€' + cartTotal.toFixed(2)"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function checkoutData() {
        return {
            cartItems: [],
            loading: true,
            error: null,
            get availableItems() {
                return this.cartItems.filter(item => !item.out_of_stock);
            },
            async fetchCartItems() {
                this.loading = true;
                this.error = null;
                try {
                    const response = await fetch('/api/cart-items/');
                    if (!response.ok) {
                        throw new Error('Failed to fetch cart items');
                    }
                    const data = await response.json();
                    this.cartItems = Array.isArray(data) ? data : [data];
                } catch (error) {
                    console.error('Error fetching cart items:', error);
                    this.error = error.message;
                } finally {
                    this.loading = false;
                }
            },
            get cartTotal() {
                return this.availableItems.reduce((total, item) => total + item.total, 0);
            },
            init() {
                this.fetchCartItems();
            }
        }
    }
</script>
</body>
</html>

